<?xml version="1.0" encoding="utf-8"?>
<Randomevents>
    <EventSprites>
        <Sprite identifier="youmujoin" texture="%ModDir%/Images/Missions/youmujoin.png" sourcerect="0,0,504,504" origin="0.7,0.7"/>
        <Sprite identifier="ayajoin" texture="%ModDir%/Images/Missions/ayajoin.png" sourcerect="0,0,504,712" origin="0.7,0.7"/>
        <Sprite identifier="mokoujoin" texture="%ModDir%/Images/Missions/mokoujoin.png" sourcerect="0,0,504,712" origin="0.7,0.7"/>
        <Sprite identifier="patchoulijoin" texture="%ModDir%/Images/Missions/patchoulijoin.png" sourcerect="0,0,504,712" origin="0.7,0.7"/>
        <Sprite identifier="yukajoin" texture="%ModDir%/Images/Missions/yukajoin.png" sourcerect="0,0,504,712" origin="0.7,0.7"/>
        <Sprite identifier="Tenshi_Join" texture="%ModDir%/Images/Missions/Tenshi_Join.png" sourcerect="0,0,504,712" origin="0.7,0.7"/>
        <Sprite identifier="Momizi_Join" texture="%ModDir%/Images/Missions/Momizi_Join.png" sourcerect="0,0,504,656" origin="0.7,0.7"/>
        <Sprite identifier="Cirno_Join" texture="%ModDir%/Images/Missions/Cirno_Join.png" sourcerect="0,0,504,610" origin="0.7,0.7"/>
        <Sprite identifier="Touhou_Akyuu_Mission" texture="%ModDir%/Images/Missions/Touhou_Akyuu_Mission.png" sourcerect="0,0,504,712"
                origin="0.7,0.7"/>
        <Sprite identifier="Reimu_Mission" texture="%ModDir%/Images/Missions/Reimu_Mission.png" sourcerect="0,0,420,300" origin="0.7,0.7"/>
    </EventSprites>

    <EventPrefabs>
        <!--妖梦入组-->
        <ScriptedEvent identifier="youmujoin" commonness="200">
            <CheckDataAction identifier="youmujoin_complete" condition="eq true">
                <Success>
                    <!--Don't repeat event-->
                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="youmukonpaku" targettag="youmu" spawnlocation="Outpost"
                                 targetmoduletags="airlock"/>
                    <TriggerAction target1tag="youmu" target2tag="player" applytotarget1="targetyoumu" applytotarget2="triggerer_player" radius="200"
                                   waitforinteraction="true"/>
                    <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c1" eventsprite="youmujoin">
                        <Option text="EventText.youmujoin.o1">
                            <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c2" eventsprite="youmujoin">
                                <Option text="EventText.youmujoin.o2">
                                    <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c3" eventsprite="youmujoin">
                                        <Option text="EventText.youmujoin.o3">
                                            <CheckItemAction targettag="triggerer_player" itemidentifiers="youmuwatermelon">
                                                <Success>
                                                    <Label name="checkwatermelon"/>
                                                    <RemoveItemAction targettag="triggerer_player" itemidentifier="youmuwatermelon"/>
                                                    <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c3.c1"
                                                                        eventsprite="youmujoin">
                                                        <Option text="EventText.youmujoin.c3.o1">
                                                            <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c3.o1.c1"
                                                                                eventsprite="youmujoin"/>
                                                            <NPCChangeTeamAction npctag="youmu" teamid="Team1" addtocrew="true"/>
                                                            <SetDataAction identifier="youmujoin_complete" value="true"/>
                                                        </Option>
                                                        <Option text="EventText.youmujoin.c3.o2">
                                                            <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c3.o2.c1"
                                                                                eventsprite="youmujoin"/>
                                                            <NPCChangeTeamAction npctag="youmu" teamid="Team1" addtocrew="true"/>
                                                            <SetDataAction identifier="youmujoin_complete" value="true"/>
                                                        </Option>
                                                    </ConversationAction>
                                                </Success>
                                                <Failure>
                                                    <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c3.c2">
                                                        <Option text="EventText.youmujoin.c3.c2.o1">
                                                            <ConversationAction targettag="triggerer_player" text="EventText.youmujoin.c3.c2.c1"/>
                                                            <Label name="waitingforwatermelon"/>
                                                            <ConversationAction text="EventText.youmujoin_return.c1" eventsprite="youmujoin"
                                                                                speakertag="youmu" dialogtype="Small">
                                                                <Option text="EventText.youmujoin_return.o1" endconversation="true">
                                                                    <CheckItemAction targettag="triggerer_player" itemidentifiers="youmuwatermelon">
                                                                        <Success>
                                                                            <GoTo name="checkwatermelon"/>
                                                                        </Success>
                                                                        <Failure>
                                                                            <ConversationAction targettag="triggerer_player"
                                                                                                waitforinteraction="false"
                                                                                                text="EventText.youmujoin_return.o1.c2"
                                                                                                eventsprite="youmujoin" dialogtype="Small"/>
                                                                            <GoTo name="waitingforwatermelon"/>
                                                                        </Failure>
                                                                    </CheckItemAction>
                                                                </Option>
                                                                <Option text="EventText.youmujoin_return.o2" endconversation="true">
                                                                    <GoTo name="waitingforwatermelon"/>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                        <Option text="EventText.youmujoin.c3.c2.o2"/>
                                                    </ConversationAction>
                                                </Failure>
                                            </CheckItemAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Option>
                    </ConversationAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--文文入组-->
        <ScriptedEvent identifier="aya_join" commonness="200">
            <CheckDataAction identifier="aya_join_complete" condition="eq true" _npos="0,0">
                <Failure>
                    <TagAction criteria="player" tag="player" _npos="600,0"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Syameimaru_Aya" targettag="Aya" spawnlocation="Outpost"
                                 targetmoduletags="airlock" _npos="1200,0"/>
                    <Label name="aya_wait_gift_list"/>
                    <TriggerAction target1tag="Aya" target2tag="player" applytotarget1="targetAya" applytotarget2="triggerer_player" radius="200"
                                   waitforinteraction="true" _npos="1800.0001,0"/>
                    <CheckDataAction identifier="aya_join_save0" condition="eq true" _npos="2400,0">
                        <Failure>
                            <ConversationAction
                                    text="EventText.aya_join.c1"
                                    targettag="triggerer_player" eventsprite="ayajoin" _npos="2400,0">
                                <Option text="EventText.aya_join.o1">
                                    <ConversationAction
                                            text="EventText.aya_join.c2"
                                            targettag="triggerer_player" eventsprite="ayajoin" _npos="3000,0">
                                        <Option text="EventText.aya_join.o2">
                                            <ConversationAction text="EventText.aya_join.c3"
                                                                targettag="triggerer_player" eventsprite="ayajoin" _npos="3600,0">
                                                <Option text="EventText.aya_join.o3">
                                                    <ConversationAction
                                                            text="EventText.aya_join.c4"
                                                            targettag="triggerer_player" eventsprite="ayajoin" _npos="4200,0">
                                                        <Option text="EventText.aya_join.o4">
                                                            <ConversationAction
                                                                    text="EventText.aya_join.c5"
                                                                    targettag="triggerer_player" eventsprite="ayajoin" dialogtype="Small"
                                                                    _npos="4852.5234,111.61743">
                                                                <Option text="EventText.aya_join.o5">
                                                                    <SetDataAction value="true" identifier="aya_join_save0" _npos="6000,0"/>
                                                                    <SetDataAction value="false" identifier="aya_join_save1" _npos="6600,0"/>
                                                                    <SetDataAction value="true" identifier="aya_join_save2" _npos="7200,0"/>
                                                                    <SetDataAction value="true" identifier="aya_join_answer" _npos="7800,0"/>
                                                                    <Goto name="Answer" _npos="8400,0"/>
                                                                </Option>
                                                                <Option text="EventText.aya_join.o6" endconversation="true">
                                                                    <ConversationAction
                                                                            text="EventText.aya_join.c6"
                                                                            targettag="triggerer_player" eventsprite="ayajoin"
                                                                            _npos="5350.732,676.9056">
                                                                        <Option text="EventText.aya_join.o7"/>
                                                                    </ConversationAction>
                                                                    <SetDataAction value="true" identifier="aya_join_save0" _npos="6728,296"/>
                                                                    <SetDataAction value="true" identifier="aya_join_save1" _npos="7328,343"/>
                                                                    <SetDataAction value="false" identifier="aya_join_answer" _npos="7928,322"/>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Failure>
                    </CheckDataAction>
                    <CheckDataAction identifier="aya_join_save1" condition="eq true" _npos="3128,678">
                        <Success>
                            <CheckDataAction identifier="aya_join_answer" condition="eq true" _npos="3728,694">
                                <Success>
                                    <Label name="Answer" _npos="5329.0503,-134.31085"/>
                                    <ConversationAction
                                            text="EventText.aya_join.c7"
                                            targettag="triggerer_player" eventsprite="ayajoin" _npos="5977.575,-134.98709">
                                        <Option text="EventText.aya_join.o8">
                                            <SetDataAction value="false" identifier="aya_join_save2" _npos="5912,1318"/>
                                            <SetDataAction value="true" identifier="aya_join_save3" _npos="6384,960"/>
                                            <Goto name="MySub" _npos="7928.4453,905.4345"/>
                                        </Option>
                                        <Option text="EventText.aya_join.o9" endconversation="true">
                                            <ConversationAction
                                                    text="EventText.aya_join.c8"
                                                    targettag="triggerer_player" eventsprite="ayajoin" _npos="6689.4717,306.1738"/>
                                            <Goto name="Return2" _npos="7131.9707,306.25043"/>
                                        </Option>
                                    </ConversationAction>
                                </Success>
                                <Failure>
                                    <Label name="Return1" _npos="5866.2407,1003.4127"/>
                                    <ConversationAction text="EventText.aya_join.c9"
                                                        speakertag="Aya" eventsprite="ayajoin" dialogtype="Small" _npos="6248.02,1447.7274">
                                        <Option text="EventText.aya_join.o10">
                                            <SetDataAction value="false" identifier="aya_join_save1" _npos="5528,402"/>
                                            <SetDataAction value="true" identifier="aya_join_save2" _npos="6256,642"/>
                                            <SetDataAction value="true" identifier="aya_join_asksub" _npos="6984,1166"/>
                                            <Goto name="Answer" _npos="6886.6523,1480.8828"/>
                                        </Option>
                                        <Option text="EventText.aya_join.o11" endconversation="true">
                                            <SetDataAction value="false" identifier="aya_join_asksub" _npos="5656,716"/>
                                            <Goto name="Return1" _npos="6834.6553,1808.8501"/>
                                        </Option>
                                    </ConversationAction>
                                </Failure>
                            </CheckDataAction>
                        </Success>
                    </CheckDataAction>
                    <CheckDataAction identifier="aya_join_save2" condition="eq true" _npos="3856,1009">
                        <Success>
                            <CheckDataAction identifier="aya_join_asksub" condition="eq true" _npos="4328,731">
                                <Success>
                                    <Label name="MySub" _npos="6618.9336,-297.40436"/>
                                    <CheckDataAction identifier="momizi_join_complete" condition="eq true">
                                        <Success>
                                            <ConversationAction
                                                    text="EventText.aya_join.c10"
                                                    targettag="triggerer_player" eventsprite="ayajoin" _npos="7191.285,-297.18378">
                                                <Option text="EventText.aya_join.o12">
                                                    <ConversationAction text="EventText.aya_join.c11"
                                                                        targettag="triggerer_player" eventsprite="ayajoin">
                                                        <Option text="EventText.aya_join.o13">
                                                            <ConversationAction
                                                                    text="EventText.aya_join.c12"
                                                                    targettag="triggerer_player" eventsprite="ayajoin"/>
                                                            <ConversationAction
                                                                    text="EventText.aya_join.c13"
                                                                    targettag="triggerer_player" eventsprite="ayajoin">
                                                                <Option text="EventText.aya_join.o14">
                                                                    <ConversationAction
                                                                            text="EventText.aya_join.c14"
                                                                            targettag="triggerer_player" eventsprite="ayajoin"/>
                                                                    <ConversationAction
                                                                            text="EventText.aya_join.c15"
                                                                            targettag="triggerer_player" eventsprite="ayajoin">
                                                                        <Option text="EventText.aya_join.o15" endconversation="true">
                                                                            <SetDataAction value="false" identifier="aya_join_save2"/>
                                                                            <SetDataAction value="false" identifier="aya_join_save3"/>
                                                                            <SetDataAction value="false" identifier="aya_gift_list_event_complete"/>
                                                                            <SetDataAction value="true"
                                                                                           identifier="aya_gift_list_event_not_complete"/>
                                                                            <TriggerEventAction identifier="Aya_Gift_List_Event"/>
                                                                            <SpawnAction itemidentifier="Touhou_Aya_Gift_List"
                                                                                         targetinventory="triggerer_player"/>
                                                                            <GoTo name="aya_wait_gift_list"/>
                                                                        </Option>
                                                                    </ConversationAction>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Success>
                                        <Failure>
                                            <ConversationAction
                                                    text="EventText.aya_join.c10"
                                                    targettag="triggerer_player" eventsprite="ayajoin" _npos="7191.285,-297.18378">
                                                <Option text="EventText.aya_join.o16">
                                                    <SetDataAction value="true" identifier="aya_join_submarine_yes" _npos="6512,1480"/>
                                                    <Goto name="Agree" _npos="8528,632"/>
                                                </Option>
                                                <Option text="EventText.aya_join.o17"
                                                        endconversation="true">
                                                    <SetDataAction value="false" identifier="aya_join_submarine_yes" _npos="6768,2016"/>
                                                    <Goto name="Return3" _npos="7878.5244,-189.5087"/>
                                                </Option>
                                            </ConversationAction>
                                        </Failure>
                                    </CheckDataAction>
                                </Success>
                                <Failure>
                                    <Label name="Return2" _npos="6671.491,1068.6614"/>
                                    <ConversationAction text="EventText.aya_join.c16"
                                                        speakertag="Aya" eventsprite="ayajoin" dialogtype="Small" _npos="7156.475,587.7698">
                                        <Option text="EventText.aya_join.o18">
                                            <SetDataAction value="false" identifier="aya_join_save2" _npos="6384,1157"/>
                                            <SetDataAction value="true" identifier="aya_join_save3" _npos="6984,991"/>
                                            <SetDataAction value="true" identifier="aya_join_submarine_yes" _npos="7584,1023"/>
                                            <Goto name="MySub" _npos="7928.4453,905.4345"/>
                                        </Option>
                                        <Option text="EventText.aya_join.o19" endconversation="true">
                                            <GoTo name="Return2" _npos="7890.9263,1068.574"/>
                                        </Option>
                                    </ConversationAction>
                                </Failure>
                            </CheckDataAction>
                        </Success>
                    </CheckDataAction>
                    <CheckDataAction identifier="aya_join_save3" condition="eq true" _npos="4456,1022">
                        <Success>
                            <CheckDataAction identifier="aya_join_submarine_yes" condition="eq true" _npos="5056,1018">
                                <Success>
                                    <Label name="Agree" _npos="7880.4795,-438.04712"/>
                                    <ConversationAction
                                            text="EventText.aya_join.c17"
                                            targettag="triggerer_player" eventsprite="ayajoin" _npos="8499.26,-0.7694702">
                                        <Option text="EventText.aya_join.o20">
                                            <ConversationAction text="EventText.aya_join.c18" targettag="triggerer_player"
                                                                eventsprite="ayajoin" _npos="9028.22,32.315094"/>
                                            <NPCChangeTeamAction npctag="Aya" teamid="Team1" addtocrew="true" _npos="9580.279,32.315125"/>
                                            <SetDataAction value="false" identifier="aya_join_save3" _npos="8184,1389"/>
                                            <SetDataAction value="false" identifier="aya_gift_list_event_not_complete"/>
                                            <SetDataAction value="true" identifier="aya_join_complete" _npos="10108.872,32.315125"/>
                                        </Option>
                                    </ConversationAction>
                                </Success>
                                <Failure>
                                    <Label name="Return3" _npos="7583.404,89.741516"/>
                                    <ConversationAction
                                            text="EventText.aya_join.c19"
                                            speakertag="Aya" eventsprite="ayajoin" dialogtype="Small" _npos="7928,287.5636">
                                        <Option text="EventText.aya_join.o21">
                                            <SetDataAction value="true" identifier="aya_join_submarine_yes" _npos="7240,1577"/>
                                            <Goto name="Agree" _npos="8528,632"/>
                                        </Option>
                                        <Option text="EventText.aya_join.o22" endconversation="true">
                                            <GoTo name="Return3" _npos="8495.293,809.2918"/>
                                        </Option>
                                    </ConversationAction>
                                </Failure>
                            </CheckDataAction>
                        </Success>
                    </CheckDataAction>
                    <CheckDataAction identifier="aya_gift_list_event_complete" condition="eq true">
                        <Success>
                            <Label name="aya_gift_list_event_complete"/>
                            <ConversationAction text="EventText.aya_join.c20"
                                                speakertag="Aya" targettag="triggerer_player" eventsprite="ayajoin">
                                <Option text="EventText.aya_join.o23">
                                    <ConversationAction text="EventText.aya_join.c21" targettag="triggerer_player" eventsprite="ayajoin"/>
                                    <NPCChangeTeamAction npctag="Aya" teamid="Team1" addtocrew="true"/>
                                    <SetDataAction value="false" identifier="aya_join_save3"/>
                                    <SetDataAction value="false" identifier="aya_gift_list_event_not_complete"/>
                                    <SetDataAction value="true" identifier="aya_join_complete"/>
                                </Option>
                            </ConversationAction>
                        </Success>
                        <Failure>
                            <CheckDataAction identifier="aya_gift_list_event_not_complete" condition="eq true">
                                <Success>
                                    <ConversationAction text="EventText.aya_join.c22" targettag="triggerer_player"
                                                        eventsprite="ayajoin"/>
                                    <GoTo name="aya_wait_gift_list"/>
                                </Success>
                            </CheckDataAction>
                        </Failure>
                    </CheckDataAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--妹红入组-->
        <ScriptedEvent identifier="mokou_join" commonness="200">
            <CheckDataAction identifier="mokou_join_complete" condition="eq true" _npos="0,0">
                <Failure>
                    <TagAction criteria="player" tag="player" _npos="600,0"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Huziwara_no_Mokou" targettag="Mokou" spawnlocation="Outpost"
                                 targetmoduletags="airlock" _npos="1200,0"/>
                    <TriggerAction target1tag="Mokou" target2tag="player" applytotarget1="targetMokou" applytotarget2="triggerer_player" radius="200"
                                   waitforinteraction="true" _npos="1800.0001,0"/>
                    <CheckDataAction identifier="mokou_save0" condition="eq true" _npos="2091.128,989.19464">
                        <Failure>
                            <ConversationAction
                                    text="EventText.mokou_join.c1"
                                    targettag="triggerer_player" eventsprite="mokoujoin" _npos="2400.003,-5.7634277">
                                <Option text="EventText.mokou_join.o1">
                                    <ConversationAction
                                            text="EventText.mokou_join.c2"
                                            targettag="triggerer_player" eventsprite="mokoujoin" _npos="3000,0">
                                        <Option text="EventText.mokou_join.o2">
                                            <ConversationAction
                                                    text="EventText.mokou_join.c3"
                                                    targettag="triggerer_player" eventsprite="mokoujoin" _npos="3600,0">
                                                <Option text="EventText.mokou_join.o3">
                                                    <SetDataAction value="true" identifier="mokou_save0" _npos="4153.884,-450.35562"/>
                                                    <SetDataAction value="true" identifier="mokou_caring" _npos="4556.515,-449.00845"/>
                                                    <GoTo name="mokou_caring" _npos="4940.624,-452.33258"/>
                                                </Option>
                                                <Option text="EventText.mokou_join.o4" endconversation="true">
                                                    <ConversationAction text="EventText.mokou_join.c4"
                                                                        targettag="triggerer_player" eventsprite="mokoujoin"
                                                                        _npos="4199.874,581.2943">
                                                        <Option text="EventText.mokou_join.o5"/>
                                                    </ConversationAction>
                                                    <SetDataAction value="true" identifier="mokou_save0" _npos="4754.742,583.1895"/>
                                                    <SetDataAction value="false" identifier="mokou_save1" _npos="5177.7725,585.4769"/>
                                                    <GoTo name="FindAgain" _npos="5593.7944,453.40225"/>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Failure>
                    </CheckDataAction>
                    <CheckDataAction identifier="mokou_caring" condition="eq true" _npos="2580.287,987.7055">
                        <Success>
                            <Label name="mokou_caring" _npos="3221.8103,1011.0821"/>
                            <ConversationAction
                                    text="EventText.mokou_join.c5"
                                    targettag="triggerer_player" eventsprite="mokoujoin" _npos="3735.826,1323.5654">
                                <Option text="EventText.mokou_join.o6">
                                    <ConversationAction
                                            text="EventText.mokou_join.c6"
                                            targettag="triggerer_player" eventsprite="mokoujoin" _npos="4336.541,1327.8457">
                                        <Option text="EventText.mokou_join.o7">
                                            <ConversationAction text="EventText.mokou_join.c7"
                                                                targettag="triggerer_player" eventsprite="mokoujoin" _npos="4915.69,1330.9735">
                                                <Option text="EventText.mokou_join.o8">
                                                    <ConversationAction
                                                            text="EventText.mokou_join.c8"
                                                            targettag="triggerer_player" eventsprite="mokoujoin" _npos="5531.058,1341.69">
                                                        <Option text="EventText.mokou_join.o9">
                                                            <SetDataAction value="false" identifier="mokou_caring" _npos="5832.4385,653.01105"/>
                                                            <SetDataAction value="true" identifier="mokou_taking" _npos="6243.0986,651.3672"/>
                                                            <Label name="mokou_taking" _npos="6706.075,652.33887"/>
                                                            <ConversationAction
                                                                    text="EventText.mokou_join.c9"
                                                                    targettag="triggerer_player" eventsprite="mokoujoin" _npos="6677.27,949.6593">
                                                                <Option text="EventText.mokou_join.o10">
                                                                    <ConversationAction
                                                                            text="EventText.mokou_join.c10"
                                                                            targettag="triggerer_player" eventsprite="mokoujoin"
                                                                            _npos="7248.359,935.0651">
                                                                        <Option text="EventText.mokou_join.o11">
                                                                            <ConversationAction
                                                                                    text="EventText.mokou_join.c11"
                                                                                    targettag="triggerer_player" eventsprite="mokoujoin"
                                                                                    _npos="7847.1353,933.9988">
                                                                                <Option text="EventText.mokou_join.o12">
                                                                                    <ConversationAction text="EventText.mokou_join.c12"
                                                                                                        targettag="triggerer_player"
                                                                                                        eventsprite="mokoujoin"
                                                                                                        _npos="8397.047,931.2226"/>
                                                                                    <NPCChangeTeamAction npctag="Mokou" teamid="Team1"
                                                                                                         addtocrew="true" _npos="8816.806,964.84186"/>
                                                                                    <SetDataAction value="false" identifier="mokou_taking"
                                                                                                   _npos="9213.233,966.84436"/>
                                                                                    <SetDataAction value="true" identifier="mokou_join_complete"
                                                                                                   _npos="9590.225,965.9047"/>
                                                                                </Option>
                                                                            </ConversationAction>
                                                                        </Option>
                                                                    </ConversationAction>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                        <Option text="EventText.mokou_join.o13" endconversation="true">
                                                            <ConversationAction text="EventText.mokou_join.c13"
                                                                                targettag="triggerer_player" eventsprite="mokoujoin"
                                                                                _npos="6247.204,1711.7551"/>
                                                            <GoTo name="MeetAgain" _npos="6771.829,1716.0947"/>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Success>
                        <Failure>
                            <CheckDataAction identifier="mokou_save1" condition="eq true" _npos="3013.8218,1357.5168">
                                <Failure>
                                    <Label name="FindAgain" _npos="3448.1306,1862.7091"/>
                                    <ConversationAction
                                            text="EventText.mokou_join.c14"
                                            speakertag="Mokou" eventsprite="mokoujoin" _npos="3949.4836,1863.6094"/>
                                    <SetDataAction value="true" identifier="mokou_caring" _npos="4400.925,1868.2146"/>
                                    <GoTo name="mokou_caring" _npos="4804.745,1875.2986"/>
                                </Failure>
                            </CheckDataAction>
                            <CheckDataAction identifier="mokou_taking" condition="eq true" _npos="3392.006,2332.1833">
                                <Success>
                                    <GoTo name="mokou_taking" _npos="4000.1187,2617.7341"/>
                                </Success>
                                <Failure>
                                    <Label name="MeetAgain" _npos="5540.5947,2394.4194"/>
                                    <ConversationAction text="EventText.mokou_join.c15" speakertag="Mokou" eventsprite="mokoujoin" dialogtype="Small"
                                                        _npos="6260.289,2394.026">
                                        <Option text="EventText.mokou_join.o14">
                                            <ConversationAction
                                                    text="EventText.mokou_join.c16"
                                                    targettag="triggerer_player" eventsprite="mokoujoin" _npos="6999.5806,2418.6975">
                                                <Option text="EventText.mokou_join.o15">
                                                    <ConversationAction text="EventText.mokou_join.c17" targettag="triggerer_player"
                                                                        eventsprite="mokoujoin" _npos="7566.41,2420.1782">
                                                        <Option text="EventText.mokou_join.o16">
                                                            <SetDataAction value="false" identifier="mokou_caring" _npos="8073.3135,2451.2947"/>
                                                            <SetDataAction value="true" identifier="mokou_taking" _npos="8481.807,2448.6548"/>
                                                            <GoTo name="mokou_taking" _npos="8879.852,2450.241"/>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                        <Option text="EventText.mokou_join.o17" endconversation="true">
                                            <SetDataAction value="false" identifier="mokou_taking" _npos="6840.6357,3062.8755"/>
                                            <GoTo name="MeetAgain" _npos="7289.8906,3061.0828"/>
                                        </Option>
                                    </ConversationAction>
                                </Failure>
                            </CheckDataAction>
                        </Failure>
                    </CheckDataAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--帕秋莉入组-->
        <ScriptedEvent identifier="patchouli_join" commonness="120">
            <CheckDataAction identifier="patchouli_join_complete" condition="eq true">
                <Success>
                    <!--Don't repeat event-->
                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Patchouli_Knowledge" targettag="Patchouli" spawnlocation="Outpost"
                                 targetmoduletags="airlock"/>
                    <TriggerAction target1tag="Patchouli" target2tag="player" applytotarget1="targetpatchouli" applytotarget2="triggerer_player"
                                   radius="200" waitforinteraction="true"/>
                    <ConversationAction targettag="triggerer_player"
                                        text="EventText.patchouli_join.c1"
                                        eventsprite="patchoulijoin">
                        <Option text="EventText.patchouli_join.o1">
                            <ConversationAction targettag="triggerer_player"
                                                text="EventText.patchouli_join.c2"
                                                eventsprite="patchoulijoin">
                                <Option text="EventText.patchouli_join.o2">
                                    <ConversationAction targettag="triggerer_player"
                                                        text="EventText.patchouli_join.c3"
                                                        eventsprite="patchoulijoin">
                                        <Option text="EventText.patchouli_join.o3">
                                            <ConversationAction targettag="triggerer_player"
                                                                text="EventText.patchouli_join.c4"
                                                                eventsprite="patchoulijoin">
                                                <Option text="EventText.patchouli_join.o4">
                                                    <CheckItemAction targettag="triggerer_player" itemidentifiers="Touhou_Budesonide">
                                                        <Success>
                                                            <Label name="Check_Touhou_Budesonide"/>
                                                            <RemoveItemAction targettag="triggerer_player" itemidentifier="Touhou_Budesonide"/>
                                                            <ConversationAction targettag="triggerer_player"
                                                                                text="EventText.patchouli_join.c5"
                                                                                eventsprite="patchoulijoin">
                                                                <Option text="EventText.patchouli_join.o5">
                                                                    <ConversationAction targettag="triggerer_player"
                                                                                        text="EventText.patchouli_join.c6"
                                                                                        eventsprite="patchoulijoin"/>
                                                                    <NPCChangeTeamAction npctag="Patchouli_Knowledge" teamid="Team1"
                                                                                         addtocrew="true"/>
                                                                    <SetDataAction identifier="patchouli_join_complete" value="true"/>
                                                                </Option>
                                                                <Option text="EventText.patchouli_join.o6">
                                                                    <ConversationAction targettag="triggerer_player"
                                                                                        text="EventText.patchouli_join.c7"
                                                                                        eventsprite="patchoulijoin"/>
                                                                    <NPCChangeTeamAction npctag="Patchouli_Knowledge" teamid="Team1"
                                                                                         addtocrew="true"/>
                                                                    <SetDataAction identifier="patchouli_join_complete" value="true"/>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Success>
                                                        <Failure>
                                                            <ConversationAction targettag="triggerer_player"
                                                                                text="EventText.patchouli_join.c8">
                                                                <Option text="EventText.patchouli_join.o7">
                                                                    <ConversationAction targettag="triggerer_player"
                                                                                        text="EventText.patchouli_join.c9"/>
                                                                    <Label name="waitingforbudesonide"/>
                                                                    <ConversationAction text="EventText.patchouli_join.c10"
                                                                                        eventsprite="patchoulijoin" speakertag="Patchouli"
                                                                                        dialogtype="Small">
                                                                        <Option text="EventText.patchouli_join.o8" endconversation="true">
                                                                            <CheckItemAction targettag="triggerer_player"
                                                                                             itemidentifiers="Touhou_Budesonide">
                                                                                <Success>
                                                                                    <GoTo name="Check_Touhou_Budesonide"/>
                                                                                </Success>
                                                                                <Failure>
                                                                                    <ConversationAction targettag="triggerer_player"
                                                                                                        waitforinteraction="false"
                                                                                                        text="EventText.patchouli_join.c11"
                                                                                                        eventsprite="patchoulijoin"
                                                                                                        dialogtype="Small"/>
                                                                                    <GoTo name="waitingforbudesonide"/>
                                                                                </Failure>
                                                                            </CheckItemAction>
                                                                        </Option>
                                                                        <Option text="EventText.patchouli_join.o9" endconversation="true">
                                                                            <GoTo name="waitingforbudesonide"/>
                                                                        </Option>
                                                                    </ConversationAction>
                                                                </Option>
                                                                <Option text="EventText.patchouli_join.o10">
                                                                    <ConversationAction targettag="triggerer_player"
                                                                                        text="EventText.patchouli_join.c12"/>
                                                                    <GoTo name="waitingforbudesonide"/>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Failure>
                                                    </CheckItemAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Option>
                    </ConversationAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>
        <!--幽香入组-->
        <ScriptedEvent identifier="yuka_join" commonness="200">
            <CheckDataAction identifier="yuka_join_complete" condition="eq true">
                <Success>
                    <!--Don't repeat event-->
                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Kazami_Yuka" targettag="Yuka" spawnlocation="Outpost"
                                 targetmoduletags="airlock"/>
                    <Label name="waitfortalk"/>
                    <TriggerAction target1tag="Yuka" target2tag="player" applytotarget1="targetyuka" applytotarget2="triggerer_player" radius="200"
                                   waitforinteraction="true"/>
                    <ConversationAction targettag="triggerer_player" speakertag="Yuka"
                                        text="EventText.yuka_join.c1"
                                        eventsprite="yukajoin">
                        <Option text="EventText.yuka_join.o1">
                            <Label name="waitfortalk2"/>
                            <ConversationAction targettag="triggerer_player"
                                                text="EventText.yuka_join.c2"
                                                eventsprite="yukajoin">
                                <Option text="EventText.yuka_join.o2">
                                    <ConversationAction targettag="triggerer_player"
                                                        text="EventText.yuka_join.c3"
                                                        eventsprite="yukajoin"/>
                                    <SetDataAction identifier="meetagain" value="true"/>
                                    <ConversationAction targettag="triggerer_player"
                                                        text="EventText.yuka_join.c4"
                                                        eventsprite="yukajoin">
                                        <Option text="EventText.yuka_join.o3">
                                            <Label name="waitfortalk3"/>
                                            <SetDataAction identifier="meetagain2" value="true"/>
                                            <ConversationAction targettag="triggerer_player" text="EventText.yuka_join.c5"
                                                                eventsprite="yukajoin">
                                                <Option text="EventText.yuka_join.o4">
                                                    <ConversationAction targettag="triggerer_player"
                                                                        text="EventText.yuka_join.c6"
                                                                        eventsprite="yukajoin">
                                                        <Option text="EventText.yuka_join.o4">
                                                            <ConversationAction targettag="triggerer_player"
                                                                                text="EventText.yuka_join.c7"
                                                                                eventsprite="yukajoin">
                                                                <Option text="EventText.yuka_join.o4">
                                                                    <ConversationAction targettag="triggerer_player"
                                                                                        text="EventText.yuka_join.c8"
                                                                                        eventsprite="yukajoin">
                                                                        <Option text="EventText.yuka_join.o5">
                                                                            <ConversationAction targettag="triggerer_player"
                                                                                                text="EventText.yuka_join.c9"
                                                                                                eventsprite="yukajoin">
                                                                                <Option text="EventText.yuka_join.o6">
                                                                                    <ConversationAction targettag="triggerer_player"
                                                                                                        text="EventText.yuka_join.c10"
                                                                                                        eventsprite="yukajoin">
                                                                                        <Option text="EventText.yuka_join.o7">
                                                                                            <ConversationAction targettag="triggerer_player"
                                                                                                                text="EventText.yuka_join.c11"
                                                                                                                eventsprite="yukajoin"/>
                                                                                            <ConversationAction targettag="triggerer_player"
                                                                                                                text="EventText.yuka_join.c12"
                                                                                                                eventsprite="yukajoin">
                                                                                                <Option text="EventText.yuka_join.o8">
                                                                                                    <ConversationAction targettag="triggerer_player"
                                                                                                                        text="EventText.yuka_join.c13"
                                                                                                                        eventsprite="yukajoin"/>
                                                                                                    <NPCChangeTeamAction npctag="Kazami_Yuka"
                                                                                                                         teamid="Team1"
                                                                                                                         addtocrew="true"/>
                                                                                                    <SetDataAction identifier="yuka_join_complete"
                                                                                                                   value="true"/>
                                                                                                </Option>
                                                                                            </ConversationAction>
                                                                                        </Option>
                                                                                    </ConversationAction>
                                                                                </Option>
                                                                            </ConversationAction>
                                                                        </Option>
                                                                    </ConversationAction>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                                <Option text="EventText.yuka_join.o9">
                                                    <ConversationAction text="EventText.yuka_join.c14" dialogtype="Small" targettag="triggerer_player"/>
                                                    <Goto name="meetagain2"/>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                        <Option text="EventText.yuka_join.o10">
                                            <ConversationAction text="EventText.yuka_join.c14" dialogtype="Small" targettag="triggerer_player"/>
                                            <Goto name="meetagain"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <Option text="EventText.yuka_join.o11">
                                    <ConversationAction text="EventText.yuka_join.c14" dialogtype="Small" targettag="triggerer_player"/>
                                    <Goto name="meetagain"/>
                                </Option>
                            </ConversationAction>
                        </Option>
                    </ConversationAction>
                    <CheckDataAction identifier="meetagain" condition="eq true">
                        <Success>
                            <!--Don't repeat event-->
                        </Success>
                        <Failure>
                            <Label name="meetagain"/>
                            <ConversationAction targettag="triggerer_player" text="EventText.yuka_join.c15"
                                                speakertag="Yuka" eventsprite="yukajoin">
                                <Option text="EventText.yuka_join.o1">
                                    <Goto name="waitfortalk2"/>
                                </Option>
                            </ConversationAction>
                            <CheckDataAction identifier="meetagain2" condition="eq true">
                                <Success>
                                    <!--Don't repeat event-->
                                </Success>
                                <Failure>
                                    <Label name="meetagain2"/>
                                    <ConversationAction targettag="triggerer_player"
                                                        text="EventText.yuka_join.c16"
                                                        speakertag="Yuka" eventsprite="yukajoin">
                                        <Option text="EventText.yuka_join.o3">
                                            <ConversationAction text="EventText.yuka_join.c17" dialogtype="Small" targettag="triggerer_player"/>
                                            <Goto name="waitfortalk3"/>
                                        </Option>
                                    </ConversationAction>
                                </Failure>
                            </CheckDataAction>
                        </Failure>
                    </CheckDataAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--天子入组-->
        <ScriptedEvent identifier="tenshi_join" commonness="200">
            <CheckDataAction identifier="tenshi_join_complete" condition="eq true">
                <Success>
                    <!--Don't repeat event-->
                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Hinanawi_Tenshi" targettag="Tenshi" spawnlocation="Outpost" targetmoduletags="airlock"/>
                    <Label name="waitfortalk"/>
                    <TriggerAction target1tag="Tenshi" target2tag="player" applytotarget1="targetTenshi" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                    <!-- 第一层对话 -->
                    <ConversationAction targettag="triggerer_player" speakertag="Tenshi" text="EventText.tenshi_join.c1" eventsprite="tenshijoin">
                        <Option text="EventText.tenshi_join.o1">
                            <!-- 第二层对话 -->
                            <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c2" eventsprite="tenshijoin">
                                <Option text="EventText.tenshi_join.o2">
                                    <!-- 第三层对话（连续两段文本） -->
                                    <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c3" eventsprite="tenshijoin"/>
                                    <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c4" eventsprite="tenshijoin">
                                        <Option text="EventText.tenshi_join.o3">
                                            <!-- 第四层对话 -->
                                            <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c5" eventsprite="tenshijoin">
                                                <Option text="EventText.tenshi_join.o4">
                                                    <!-- 第五层对话 -->
                                                    <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c6" eventsprite="tenshijoin">
                                                        <Option text="EventText.tenshi_join.o5">
                                                            <!-- 第六层对话（提示找帽子） -->
                                                            <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c7" eventsprite="tenshijoin"/>
                                                            <Label name="Check_Tenshi_Hat"/>
                                                            <!-- 检查帽子物品 -->
                                                            <CheckItemAction targettag="triggerer_player" itemidentifiers="Tenshi_Hat">
                                                                <Success>
                                                                    <RemoveItemAction targettag="triggerer_player" itemidentifier="Tenshi_Hat"/>
                                                                    <!-- 交还帽子后的对话 -->
                                                                    <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c9" eventsprite="tenshijoin"/>
                                                                    <SpawnAction itemidentifier="Touhou_Tenshi_Peach" targetinventory="triggerer_player"/>
                                                                    <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c10" eventsprite="tenshijoin">
                                                                        <Option text="EventText.tenshi_join.o7">
                                                                            <!-- 索要更多报酬的对话 -->
                                                                            <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c11" eventsprite="tenshijoin">
                                                                                <Option text="EventText.tenshi_join.o8">
                                                                                    <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c12" eventsprite="tenshijoin"/>
                                                                                    <!-- 入组操作 -->
                                                                                    <NPCChangeTeamAction npctag="Hinanawi_Tenshi" teamid="Team1" addtocrew="true"/>
                                                                                    <SetDataAction identifier="tenshi_join_complete" value="true"/>
                                                                                </Option>
                                                                            </ConversationAction>
                                                                        </Option>
                                                                    </ConversationAction>
                                                                </Success>
                                                                <Failure>
                                                                    <!-- 未找到帽子的提示 -->
                                                                    <ConversationAction targettag="triggerer_player" text="EventText.tenshi_join.c13" speakertag="Tenshi" eventsprite="tenshijoin"/>
                                                                    <Goto name="Check_Tenshi_Hat"/>
                                                                </Failure>
                                                            </CheckItemAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Option>
                    </ConversationAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--椛入组-->
        <ScriptedEvent identifier="momizi_join" commonness="200">
            <CheckDataAction identifier="momizi_join_complete" condition="eq true">
                <Success>
                    <!--Don't repeat event-->
                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Inubashiri_Momizi" targettag="Momizi" spawnlocation="Outpost" targetmoduletags="airlock"/>
                    <TriggerAction target1tag="Momizi" target2tag="player" applytotarget1="targetMomizi" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                    <ConversationAction targettag="triggerer_player" speakertag="Momizi" text="EventText.momizi_join.c1" eventsprite="momizijoin">
                        <Option text="EventText.momizi_join.o1">
                            <Label name="Momizi_Meetagain2"/>
                            <CheckDataAction identifier="aya_join_complete" condition="eq true">
                                <Success>
                                    <SetDataAction identifier="Momizi_Meetagain2" value="false"/>
                                    <SetDataAction identifier="Momizi_Find_IDcard_Event_Complete" value="false"/>
                                    <SetDataAction identifier="Momizi_Find_IDcard_Event_Not_Complete" value="false"/>
                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c2" eventsprite="momizijoin"/>
                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c3" eventsprite="momizijoin">
                                        <Option text="EventText.momizi_join.o2">
                                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c4" eventsprite="momizijoin">
                                                <Option text="EventText.momizi_join.o3">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c5" eventsprite="momizijoin">
                                                        <Option text="EventText.momizi_join.o4">
                                                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c6" eventsprite="momizijoin">
                                                                <Option text="EventText.momizi_join.o5" endconversation="true">
                                                                    <NPCChangeTeamAction npctag="Inubashiri_Momizi" teamid="Team1" addtocrew="true"/>
                                                                    <SetDataAction identifier="momizi_join_complete" value="true"/>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Success>
                                <Failure>
                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c2" eventsprite="momizijoin"/>
                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c3" eventsprite="momizijoin">
                                        <Option text="EventText.momizi_join.o6">
                                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c7" eventsprite="momizijoin"/>
                                            <SetDataAction identifier="Momizi_Meetagain2" value="true"/>
                                            <Goto name="Momizi_Meetagain3"/>
                                        </Option>
                                    </ConversationAction>
                                </Failure>
                            </CheckDataAction>
                        </Option>
                        <Option text="EventText.momizi_join.o7">
                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c8" eventsprite="momizijoin"/>
                            <SetDataAction identifier="Momizi_Meetagain" value="true"/>
                            <Goto name="Momizi_Meetagain"/>
                        </Option>
                    </ConversationAction>
                    <Label name="Momizi_Meetagain"/>
                    <CheckDataAction identifier="Momizi_Meetagain" condition="eq true">
                        <Success>
                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c9" speakertag="Momizi" eventsprite="momizijoin">
                                <Option text="EventText.momizi_join.o1">
                                    <SetDataAction identifier="Momizi_Meetagain" value="false"/>
                                    <Goto name="Momizi_Meetagain2"/>
                                </Option>
                            </ConversationAction>
                        </Success>
                    </CheckDataAction>
                    <Label name="Momizi_Meetagain3"/>
                    <CheckDataAction identifier="Momizi_Meetagain2" condition="eq true">
                        <Success>
                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c10" speakertag="Momizi" eventsprite="momizijoin">
                                <Option text="EventText.momizi_join.o8">
                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c11" eventsprite="momizijoin">
                                        <Option text="EventText.momizi_join.o9">
                                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c12" eventsprite="momizijoin">
                                                <Option text="EventText.momizi_join.o10">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c13" eventsprite="momizijoin"/>
                                                    <TriggerEventAction identifier="Momizi_Find_IDcard_Event"/>
                                                    <SetDataAction identifier="Momizi_Find_IDcard" value="true"/>
                                                    <SetDataAction identifier="Momizi_Find_IDcard_Event_Not_Complete" value="true"/>
                                                    <SetDataAction identifier="Momizi_Find_IDcard_Event_Complete" value="false"/>
                                                    <Goto name="Wait_For_IDcard"/>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Success>
                    </CheckDataAction>
                    <Label name="Wait_For_IDcard"/>
                    <CheckDataAction identifier="Momizi_Find_IDcard_Event_Complete" condition="eq true">
                        <Success>
                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c14" speakertag="Momizi" eventsprite="momizijoin"/>
                            <NPCChangeTeamAction npctag="Inubashiri_Momizi" teamid="Team1" addtocrew="true"/>
                            <SetDataAction identifier="momizi_join_complete" value="true"/>
                        </Success>
                        <Failure>
                            <CheckDataAction identifier="Momizi_Find_IDcard_Event_Not_Complete" condition="eq true">
                                <Success>
                                    <ConversationAction targettag="triggerer_player" text="EventText.momizi_join.c15" speakertag="Momizi" eventsprite="momizijoin"/>
                                    <GoTo name="Wait_For_IDcard"/>
                                </Success>
                            </CheckDataAction>
                        </Failure>
                    </CheckDataAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--补办椛的证件-->
        <ScriptedEvent identifier="Momizi_Find_IDcard_Event" commonness="0">
            <TagAction criteria="player" tag="player"/>
            <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Momizi_Event_Outpost_Manager" targettag="Momizi_Event_Outpost_Manager" spawnlocation="Outpost" targetmoduletags="airlock"/>
            <Label name="waitfortalk"/>
            <NPCWaitAction npctag="Momizi_Event_Outpost_Manager" wait="true"/>
            <TriggerAction target1tag="Momizi_Event_Outpost_Manager" target2tag="player" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
            <ConversationAction targettag="triggerer_player" speakertag="Momizi_Event_Outpost_Manager" text="EventText.momizi_idcard_event.c1" eventsprite="momizi_idcard_event">
                <Option text="EventText.momizi_idcard_event.o1">
                    <CheckMoneyAction amount="50">
                        <Success>
                            <MoneyAction amount="-50"/>
                            <ConversationAction text="EventText.momizi_idcard_event.c2" targettag="triggerer_player" eventsprite="momizi_idcard_event"/>
                            <SetDataAction identifier="momizi_find_idcard_event_complete" value="true"/>
                        </Success>
                        <Failure>
                            <ConversationAction targettag="triggerer_player" text="EventText.momizi_idcard_event.c3" eventsprite="momizi_idcard_event"/>
                            <Goto name="waitfortalk"/>
                        </Failure>
                    </CheckMoneyAction>
                </Option>
                <Option text="EventText.momizi_idcard_event.o2" endconversation="true">
                    <GoTo name="waitfortalk"/>
                </Option>
            </ConversationAction>
            <NPCWaitAction npctag="Momizi_Event_Outpost_Manager" wait="false"/>
        </ScriptedEvent>

        <!--文文的礼物清单事件-->
        <ScriptedEvent identifier="Aya_Gift_List_Event" commonness="0">
            <TagAction criteria="player" tag="player"/>
            <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Aya_Event_Outpost_Merchant" targettag="Aya_Event_Outpost_Merchant" spawnlocation="Outpost" targetmoduletags="airlock"/>
            <Label name="waitfortalk"/>
            <NPCWaitAction npctag="Aya_Event_Outpost_Merchant" wait="true"/>
            <TriggerAction target1tag="Aya_Event_Outpost_Merchant" target2tag="player" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
            <ConversationAction targettag="triggerer_player" speakertag="Aya_Event_Outpost_Merchant" text="EventText.aya_gift_list_event.c1" eventsprite="aya_gift_list_event"/>
            <ConversationAction targettag="triggerer_player" text="EventText.aya_gift_list_event.c2" eventsprite="aya_gift_list_event">
                <Option text="EventText.aya_gift_list_event.o1" endconversation="true">
                    <CheckMoneyAction amount="300">
                        <Success>
                            <MoneyAction amount="-300"/>
                            <RemoveItemAction targettag="triggerer_player" itemidentifier="Touhou_Aya_Gift_List"/>
                            <SetDataAction identifier="aya_gift_list_event_complete" value="true"/>
                        </Success>
                        <Failure>
                            <ConversationAction targettag="triggerer_player" text="EventText.aya_gift_list_event.c3" eventsprite="aya_gift_list_event"/>
                            <Goto name="waitfortalk"/>
                        </Failure>
                    </CheckMoneyAction>
                </Option>
                <Option text="EventText.aya_gift_list_event.o2" endconversation="true">
                    <GoTo name="waitfortalk"/>
                </Option>
            </ConversationAction>
            <NPCWaitAction npctag="Aya_Event_Outpost_Merchant" wait="false"/>
        </ScriptedEvent>
        <!--阿求入组-->
        <ScriptedEvent identifier="akyuu_join" commonness="233">
            <CheckDataAction identifier="akyuu_join_complete" condition="eq true">
                <Success>
                    <!--Don't repeat event-->
                </Success>
                <Failure>
                    <CheckDataAction identifier="Touhou_Find_Nue_Mission_End" condition="eq true">
                        <Success>
                            <CheckReputationAction targettype="faction" identifier="Touhou_Gensokyo" condition="gte 40">
                                <Success>
                                    <TagAction criteria="player" tag="player"/>
                                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Hieda_no_Akyuu" targettag="Hieda_no_Akyuu" spawnlocation="Outpost" targetmoduletags="airlock"/>
                                    <Label name="waitfortalk"/>
                                    <TriggerAction target1tag="Hieda_no_Akyuu" target2tag="player" applytotarget1="Hieda_no_Akyuu" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                                    <CheckDataAction identifier="Akyuu_Meet_Again" condition="eq true">
                                        <Success>
                                            <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c1" eventsprite="touhou_akyuu_mission">
                                                <Option text="EventText.akyuu_join.o1">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c2" eventsprite="touhou_akyuu_mission"/>
                                                    <NPCChangeTeamAction npctag="Hieda_no_Akyuu" teamid="Team1" addtocrew="true"/>
                                                    <SetDataAction identifier="Akyuu_Meet_Again" value="false"/>
                                                    <SetDataAction identifier="akyuu_join_complete" value="true"/>
                                                </Option>
                                                <Option text="EventText.akyuu_join.o2">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c3"/>
                                                    <SetDataAction identifier="Akyuu_Meet_Again" value="true"/>
                                                    <GoTo name="waitfortalk"/>
                                                </Option>
                                            </ConversationAction>
                                        </Success>
                                        <Failure>
                                            <ConversationAction targettag="triggerer_player" speakertag="Hieda_no_Akyuu" text="EventText.akyuu_join.c4" eventsprite="touhou_akyuu_mission">
                                                <Option text="EventText.akyuu_join.o3">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c5" eventsprite="touhou_akyuu_mission">
                                                        <Option text="EventText.akyuu_join.o3">
                                                            <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c6">
                                                                <Option text="EventText.akyuu_join.o3">
                                                                    <CheckDataAction identifier="Player_Donated" condition="eq true">
                                                                        <Success>
                                                                            <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c7" eventsprite="touhou_akyuu_mission">
                                                                                <Option text="EventText.akyuu_join.o4">
                                                                                    <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c8" eventsprite="touhou_akyuu_mission">
                                                                                        <Option text="EventText.akyuu_join.o5">
                                                                                            <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c9" eventsprite="touhou_akyuu_mission"/>
                                                                                            <NPCChangeTeamAction npctag="Hieda_no_Akyuu" teamid="Team1" addtocrew="true"/>
                                                                                            <SpawnAction itemidentifier="Power_Point" targetinventory="triggerer_player" amount="2"/>
                                                                                            <SpawnAction itemidentifier="Touhou_Precious_Metal" targetinventory="triggerer_player" amount="2"/>
                                                                                            <SetDataAction identifier="Akyuu_Meet_Again" value="false"/>
                                                                                            <SetDataAction identifier="akyuu_join_complete" value="true"/>
                                                                                        </Option>
                                                                                    </ConversationAction>
                                                                                </Option>
                                                                            </ConversationAction>
                                                                        </Success>
                                                                        <Failure>
                                                                            <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c10" eventsprite="touhou_akyuu_mission">
                                                                                <Option text="EventText.akyuu_join.o6">
                                                                                    <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c11" eventsprite="touhou_akyuu_mission">
                                                                                        <Option text="EventText.akyuu_join.o7">
                                                                                            <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c12" eventsprite="touhou_akyuu_mission">
                                                                                                <Option text="EventText.akyuu_join.o1">
                                                                                                    <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c2" eventsprite="touhou_akyuu_mission"/>
                                                                                                    <NPCChangeTeamAction npctag="Hieda_no_Akyuu" teamid="Team1" addtocrew="true"/>
                                                                                                    <SpawnAction itemidentifier="Power_Point" targetinventory="triggerer_player" amount="1"/>
                                                                                                    <SpawnAction itemidentifier="Touhou_Precious_Metal" targetinventory="triggerer_player" amount="1"/>
                                                                                                    <SetDataAction identifier="Akyuu_Meet_Again" value="false"/>
                                                                                                    <SetDataAction identifier="akyuu_join_complete" value="true"/>
                                                                                                </Option>
                                                                                                <Option text="EventText.akyuu_join.o2">
                                                                                                    <ConversationAction targettag="triggerer_player" text="EventText.akyuu_join.c3"/>
                                                                                                    <SetDataAction identifier="Akyuu_Meet_Again" value="true"/>
                                                                                                    <GoTo name="waitfortalk"/>
                                                                                                </Option>
                                                                                            </ConversationAction>
                                                                                        </Option>
                                                                                    </ConversationAction>
                                                                                </Option>
                                                                            </ConversationAction>
                                                                        </Failure>
                                                                    </CheckDataAction>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Failure>
                                    </CheckDataAction>
                                </Success>
                                <Failure>
                                    <!--标记-->
                                    <!--前置任务，灵异珠事件-->
                                </Failure>
                            </CheckReputationAction>
                        </Success>
                        <Failure>

                        </Failure>
                    </CheckDataAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>
        <!--阿求任务-->
        <ScriptedEvent identifier="touhou_akyuu_mission" commonness="100">
            <CheckDataAction identifier="akyuu_join_complete" condition="eq true">
                <Success>

                </Success>
                <Failure>
                    <CheckDataAction identifier="touhou_ufo_mission_ing" condition="eq true">
                        <Failure>
                            <TagAction criteria="player" tag="player"/>
                            <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hieda_no_Akyuu" targettag="Mission_Hieda_no_Akyuu" spawnlocation="Outpost" targetmoduletags="airlock"/>
                            <Label name="waitformission"/>
                            <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="true"/>
                            <TriggerAction target1tag="Mission_Hieda_no_Akyuu" target2tag="player" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                            <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_mission.c1" eventsprite="touhou_akyuu_mission">
                                <!-- 魔法物质运输 -->
                                <Option text="EventText.touhou_akyuu_mission.o1">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c2" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_mission.o2">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c3" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                            <MissionAction missiontag="cargoMagicItems"/>
                                        </Option>
                                        <Option text="EventText.touhou_akyuu_mission.o3">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c4" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 食物原料运输 -->
                                <Option text="EventText.touhou_akyuu_mission.o4">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c5" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_mission.o2">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c6" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                            <MissionAction missiontag="Cargo_Touhou_Food_Ingredients"/>
                                        </Option>
                                        <Option text="EventText.touhou_akyuu_mission.o3">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c7" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 清理毛玉 -->
                                <Option text="EventText.touhou_akyuu_mission.o5">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c8" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_mission.o2">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c9" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                            <MissionAction missiontag="killMaoyu"/>
                                        </Option>
                                        <Option text="EventText.touhou_akyuu_mission.o3">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c10" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 幽灵线 -->
                                <Option text="EventText.touhou_akyuu_mission.o6">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c11" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_mission.o2">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c12" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                            <MissionAction missiontag="killghost"/>
                                        </Option>
                                        <Option text="EventText.touhou_akyuu_mission.o3">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c13" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 长眠不醒的噩梦 -->
                                <Option text="EventText.touhou_akyuu_mission.o7">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c14" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_mission.o2">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c15" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                            <MissionAction missiontag="killphotosphere"/>
                                        </Option>
                                        <Option text="EventText.touhou_akyuu_mission.o3">
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c16" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 特别委托 -->
                                <Option text="EventText.touhou_akyuu_mission.o8">
                                    <CheckReputationAction targettype="faction" identifier="Touhou_Gensokyo" condition="gte 60">
                                        <Success>
                                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c17" eventsprite="touhou_akyuu_mission">
                                                <Option text="EventText.touhou_akyuu_mission.o2">
                                                    <ConversationAction text="EventText.touhou_akyuu_mission.c18" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                    <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player" amount="3"/>
                                                    <SpawnAction itemidentifier="antibleeding1" targetinventory="triggerer_player" amount="3"/>
                                                    <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                                    <MissionAction missiontag="killgreenufo"/>
                                                    <MissionAction missiontag="killredufo"/>
                                                    <MissionAction missiontag="killblueufo"/>
                                                </Option>
                                                <Option text="EventText.touhou_akyuu_mission.o3">
                                                    <ConversationAction text="EventText.touhou_akyuu_mission.c19" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                    <ClearTagAction tag="triggerer_player"/>
                                                    <GoTo name="waitformission"/>
                                                </Option>
                                            </ConversationAction>
                                        </Success>
                                        <Failure>
                                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c20" eventsprite="touhou_akyuu_mission">
                                                <Option text="EventText.touhou_akyuu_mission.o2">
                                                    <ConversationAction text="EventText.touhou_akyuu_mission.c18" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                    <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player"/>
                                                    <SpawnAction itemidentifier="antidama1" targetinventory="triggerer_player"/>
                                                    <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                                    <MissionAction missiontag="killgreenufo"/>
                                                </Option>
                                                <Option text="EventText.touhou_akyuu_mission.o3">
                                                    <ConversationAction text="EventText.touhou_akyuu_mission.c21" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                    <ClearTagAction tag="triggerer_player"/>
                                                    <GoTo name="waitformission"/>
                                                </Option>
                                            </ConversationAction>
                                        </Failure>
                                    </CheckReputationAction>
                                </Option>
                                <!-- 秘密委托（需要优先完成整个UFO任务线） -->
                                <Option text="EventText.touhou_akyuu_mission.o9">
                                    <CheckDataAction identifier="touhou_find_nue_mission_end" condition="eq true">
                                        <Success>
                                            <CheckDataAction identifier="salvage_mysterious_pearl_completed" condition="eq true">
                                                <Success>
                                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c22" eventsprite="touhou_akyuu_mission">
                                                        <Option text="EventText.touhou_akyuu_mission.o10">
                                                            <CheckItemAction itemidentifiers="Salvage_Mysterious_Pearl_Mission_Completed" targettag="triggerer_player">
                                                                <Success>
                                                                    <ConversationAction text="EventText.touhou_akyuu_mission.c23" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                                    <RemoveItemAction itemidentifier="Salvage_Mysterious_Pearl_Mission_Completed" targettag="triggerer_player"/>
                                                                    <SpawnAction itemidentifier="Touhou_Mysterious_Pearl_Rippling" targetinventory="triggerer_player"/>
                                                                    <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                                                    <SetDataAction identifier="touhou_mysterious_pearl_rippling_completed" value="true"/>
                                                                </Success>
                                                                <Failure>
                                                                    <ConversationAction text="EventText.touhou_akyuu_mission.c24" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                                    <ClearTagAction tag="triggerer_player"/>
                                                                    <GoTo name="waitformission"/>
                                                                </Failure>
                                                            </CheckItemAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Success>
                                                <Failure>
                                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_mission.c25" eventsprite="touhou_akyuu_mission">
                                                        <Option text="EventText.touhou_akyuu_mission.o2">
                                                            <ConversationAction text="EventText.touhou_akyuu_mission.c26" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                            <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player" amount="4"/>
                                                            <SpawnAction itemidentifier="antibleeding1" targetinventory="triggerer_player" amount="4"/>
                                                            <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                                            <MissionAction missiontag="Salvage_Mysterious_Pearl"/>
                                                        </Option>
                                                        <Option text="EventText.touhou_akyuu_mission.o3" endconversation="true">
                                                            <ClearTagAction tag="triggerer_player"/>
                                                            <GoTo name="waitformission"/>
                                                        </Option>
                                                    </ConversationAction>
                                                </Failure>
                                            </CheckDataAction>
                                        </Success>
                                        <Failure>
                                            <ConversationAction text="EventText.touhou_akyuu_mission.c27" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Failure>
                                    </CheckDataAction>
                                </Option>
                                <!-- 以后再说 -->
                                <Option text="EventText.touhou_akyuu_mission.o11">
                                    <ConversationAction text="EventText.touhou_akyuu_mission.c28" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                    <ClearTagAction tag="triggerer_player"/>
                                    <GoTo name="waitformission"/>
                                </Option>
                            </ConversationAction>
                            <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="false"/>
                        </Failure>
                        <Success>

                        </Success>
                    </CheckDataAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>
        <!--已击败绿UFO-->
        <ScriptedEvent identifier="touhou_akyuu_ufo_mission01" commonness="0">
            <CheckDataAction identifier="touhou_find_nue_mission_end" condition="eq true">
                <Success>

                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hieda_no_Akyuu" targettag="Mission_Hieda_no_Akyuu" spawnlocation="MainSub" targetmoduletags="airlock"/>
                    <Label name="waitformission"/>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="true"/>
                    <TriggerAction target1tag="Mission_Hieda_no_Akyuu" target2tag="player" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission01.c1" eventsprite="touhou_akyuu_mission">
                        <!-- 特别委托 -->
                        <Option text="EventText.touhou_akyuu_ufo_mission01.o1">
                            <CheckDataAction identifier="touhou_green_ufo_mission" condition="eq true">
                                <Success>
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission01.c2" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_ufo_mission01.o2">
                                            <ConversationAction text="EventText.touhou_akyuu_ufo_mission01.c3" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player"/>
                                            <SpawnAction itemidentifier="antibleeding1" targetinventory="triggerer_player" amount="2"/>
                                            <SpawnAction itemidentifier="Touhou_Missions_Collection_Green_UFO" targetinventory="triggerer_player"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <MissionAction missiontag="killredufo"/>
                                            <SetDataAction identifier="touhou_akyuu_ufo_mission01_agree" value="true"/>
                                            <SetDataAction identifier="touhou_green_ufo_mission" value="false"/>
                                            <SetDataAction identifier="touhou_ufo_mission_ing" value="true"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                        <Option text="EventText.touhou_akyuu_ufo_mission01.o3">
                                            <ConversationAction text="EventText.touhou_akyuu_ufo_mission01.c4" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Success>
                                <Failure>
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission01.c5" eventsprite="touhou_akyuu_mission"/>
                                    <GoTo name="waitformission"/>
                                </Failure>
                            </CheckDataAction>
                        </Option>
                        <!-- 真相不明-忠义绿色UFO -->
                        <Option text="EventText.touhou_akyuu_ufo_mission01.o4">
                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission01.c6" eventsprite="touhou_akyuu_mission">
                                <Option text="EventText.touhou_akyuu_ufo_mission01.o5" endconversation="true">
                                    <SpawnAction itemidentifier="Touhou_Missions_Collection_Green_UFO" targetinventory="triggerer_player"/>
                                    <ClearTagAction tag="triggerer_player"/>
                                    <GoTo name="waitformission"/>
                                </Option>
                            </ConversationAction>
                        </Option>
                        <!-- 以后再说 -->
                        <Option text="EventText.touhou_akyuu_ufo_mission01.o6">
                            <ConversationAction text="EventText.touhou_akyuu_ufo_mission01.c7" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                            <ClearTagAction tag="triggerer_player"/>
                            <GoTo name="waitformission"/>
                        </Option>
                    </ConversationAction>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="false"/>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>
        <!--已击败红UFO-->
        <ScriptedEvent identifier="touhou_akyuu_ufo_mission02" commonness="0">
            <CheckDataAction identifier="touhou_find_nue_mission_end" condition="eq true">
                <Success>

                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hieda_no_Akyuu" targettag="Mission_Hieda_no_Akyuu" spawnlocation="MainSub" targetmoduletags="airlock"/>
                    <Label name="waitformission"/>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="true"/>
                    <TriggerAction target1tag="Mission_Hieda_no_Akyuu" target2tag="player" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                    <CheckDataAction identifier="touhou_akyuu_ufo_mission02_agree" condition="eq true">
                        <Success>
                            <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission02.c1" eventsprite="touhou_akyuu_mission">
                                <!-- 真相不明-愤怒红色UFO -->
                                <Option text="EventText.touhou_akyuu_ufo_mission02.o1">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission02.c2" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_ufo_mission02.o2" endconversation="true">
                                            <SpawnAction itemidentifier="Touhou_Missions_Collection_Red_UFO" targetinventory="triggerer_player"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 以后再说 -->
                                <Option text="EventText.touhou_akyuu_ufo_mission02.o3">
                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission02.c3" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                    <ClearTagAction tag="triggerer_player"/>
                                    <GoTo name="waitformission"/>
                                </Option>
                            </ConversationAction>
                        </Success>
                        <Failure>
                            <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission02.c1" eventsprite="touhou_akyuu_mission">
                                <!-- 特别委托 -->
                                <Option text="EventText.touhou_akyuu_ufo_mission02.o4">
                                    <CheckDataAction identifier="touhou_red_ufo_mission" condition="eq true">
                                        <Success>
                                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission02.c4" eventsprite="touhou_akyuu_mission">
                                                <Option text="EventText.touhou_akyuu_ufo_mission02.o5">
                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission02.c5" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                    <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player"/>
                                                    <SpawnAction itemidentifier="antibleeding1" targetinventory="triggerer_player" amount="2"/>
                                                    <SpawnAction itemidentifier="Touhou_Missions_Collection_Red_UFO" targetinventory="triggerer_player"/>
                                                    <ClearTagAction tag="triggerer_player"/>
                                                    <MissionAction missiontag="killblueufo"/>
                                                    <SetDataAction identifier="touhou_akyuu_ufo_mission02_agree" value="true"/>
                                                    <SetDataAction identifier="touhou_red_ufo_mission" value="false"/>
                                                    <GoTo name="waitformission"/>
                                                </Option>
                                                <Option text="EventText.touhou_akyuu_ufo_mission02.o6">
                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission02.c6" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                    <ClearTagAction tag="triggerer_player"/>
                                                    <GoTo name="waitformission"/>
                                                </Option>
                                            </ConversationAction>
                                        </Success>
                                        <Failure>
                                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission02.c7" eventsprite="touhou_akyuu_mission"/>
                                            <GoTo name="waitformission"/>
                                        </Failure>
                                    </CheckDataAction>
                                </Option>
                                <!-- 真相不明-愤怒红色UFO -->
                                <Option text="EventText.touhou_akyuu_ufo_mission02.o1">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission02.c2" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_ufo_mission02.o2" endconversation="true">
                                            <SpawnAction itemidentifier="Touhou_Missions_Collection_Red_UFO" targetinventory="triggerer_player"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 以后再说 -->
                                <Option text="EventText.touhou_akyuu_ufo_mission02.o3">
                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission02.c3" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                    <ClearTagAction tag="triggerer_player"/>
                                    <GoTo name="waitformission"/>
                                </Option>
                            </ConversationAction>
                        </Failure>
                    </CheckDataAction>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="false"/>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>
        <!--已击败蓝UFO-->
        <ScriptedEvent identifier="touhou_akyuu_ufo_mission03" commonness="0">
            <CheckDataAction identifier="touhou_find_nue_mission_end" condition="eq true">
                <Success>

                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hieda_no_Akyuu" targettag="Mission_Hieda_no_Akyuu" spawnlocation="MainSub" targetmoduletags="airlock"/>
                    <Label name="waitformission"/>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="true"/>
                    <TriggerAction target1tag="Mission_Hieda_no_Akyuu" target2tag="player" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                    <CheckDataAction identifier="touhou_akyuu_ufo_mission03_agree" condition="eq true">
                        <Success>
                            <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission03.c1" eventsprite="touhou_akyuu_mission">
                                <!-- 真相不明-哀愁蓝色UFO -->
                                <Option text="EventText.touhou_akyuu_ufo_mission03.o1">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission03.c2" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_ufo_mission03.o2" endconversation="true">
                                            <SpawnAction itemidentifier="Touhou_Missions_Collection_Blue_UFO" targetinventory="triggerer_player"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 以后再说 -->
                                <Option text="EventText.touhou_akyuu_ufo_mission03.o3">
                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c3" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                    <ClearTagAction tag="triggerer_player"/>
                                    <GoTo name="waitformission"/>
                                </Option>
                            </ConversationAction>
                        </Success>
                        <Failure>
                            <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission03.c1" eventsprite="touhou_akyuu_mission">
                                <!-- 特别委托 -->
                                <Option text="EventText.touhou_akyuu_ufo_mission03.o4">
                                    <CheckDataAction identifier="touhou_blue_ufo_mission" condition="eq true">
                                        <Success>
                                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission03.c4" eventsprite="touhou_akyuu_mission">
                                                <!-- 先听好消息 -->
                                                <Option text="EventText.touhou_akyuu_ufo_mission03.o5">
                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c5" targettag="triggerer_player" eventsprite="touhou_akyuu_mission">
                                                        <Option text="EventText.touhou_akyuu_ufo_mission03.o6">
                                                            <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c6" targettag="triggerer_player" eventsprite="touhou_akyuu_mission">
                                                                <Option text="EventText.touhou_akyuu_ufo_mission03.o7">
                                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c7" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                                    <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player" amount="4"/>
                                                                    <SpawnAction itemidentifier="antibleeding3" targetinventory="triggerer_player"/>
                                                                    <ClearTagAction tag="triggerer_player"/>
                                                                    <MissionAction missiontag="FindHoujuuNue"/>
                                                                    <SetDataAction identifier="touhou_akyuu_ufo_mission03_agree" value="true"/>
                                                                    <SetDataAction identifier="touhou_blue_ufo_mission" value="false"/>
                                                                    <GoTo name="waitformission"/>
                                                                </Option>
                                                                <Option text="EventText.touhou_akyuu_ufo_mission03.o8">
                                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c8" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                                    <ClearTagAction tag="triggerer_player"/>
                                                                    <GoTo name="waitformission"/>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                                <!-- 先听坏消息 -->
                                                <Option text="EventText.touhou_akyuu_ufo_mission03.o9">
                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c6" targettag="triggerer_player" eventsprite="touhou_akyuu_mission">
                                                        <Option text="EventText.touhou_akyuu_ufo_mission03.o10">
                                                            <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c7" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                            <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player" amount="4"/>
                                                            <SpawnAction itemidentifier="antibleeding3" targetinventory="triggerer_player"/>
                                                            <SpawnAction itemidentifier="Touhou_Missions_Collection_Blue_UFO" targetinventory="triggerer_player"/>
                                                            <ClearTagAction tag="triggerer_player"/>
                                                            <MissionAction missiontag="FindHoujuuNue"/>
                                                            <SetDataAction identifier="touhou_akyuu_ufo_mission03_agree" value="true"/>
                                                            <GoTo name="waitformission"/>
                                                        </Option>
                                                        <Option text="EventText.touhou_akyuu_ufo_mission03.o11">
                                                            <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c9" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission">
                                                                <Option text="EventText.touhou_akyuu_ufo_mission03.o7">
                                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c7" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                                    <SpawnAction itemidentifier="Europa_Infusion" targetinventory="triggerer_player" amount="4"/>
                                                                    <SpawnAction itemidentifier="antibleeding3" targetinventory="triggerer_player"/>
                                                                    <SpawnAction itemidentifier="Touhou_Missions_Collection_Blue_UFO" targetinventory="triggerer_player"/>
                                                                    <ClearTagAction tag="triggerer_player"/>
                                                                    <MissionAction missiontag="FindHoujuuNue"/>
                                                                    <SetDataAction identifier="touhou_akyuu_ufo_mission03_agree" value="true"/>
                                                                    <GoTo name="waitformission"/>
                                                                </Option>
                                                                <Option text="EventText.touhou_akyuu_ufo_mission03.o8">
                                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c8" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                                    <ClearTagAction tag="triggerer_player"/>
                                                                    <GoTo name="waitformission"/>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                                <!-- 我想先休息会儿 -->
                                                <Option text="EventText.touhou_akyuu_ufo_mission03.o12">
                                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c10" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                                    <ClearTagAction tag="triggerer_player"/>
                                                    <GoTo name="waitformission"/>
                                                </Option>
                                            </ConversationAction>
                                        </Success>
                                        <Failure>
                                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission03.c11" eventsprite="touhou_akyuu_mission"/>
                                            <GoTo name="waitformission"/>
                                        </Failure>
                                    </CheckDataAction>
                                </Option>
                                <!-- 真相不明-哀愁蓝色UFO -->
                                <Option text="EventText.touhou_akyuu_ufo_mission03.o1">
                                    <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission03.c2" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_ufo_mission03.o2" endconversation="true">
                                            <SpawnAction itemidentifier="Touhou_Missions_Collection_Blue_UFO" targetinventory="triggerer_player"/>
                                            <ClearTagAction tag="triggerer_player"/>
                                            <GoTo name="waitformission"/>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <!-- 以后再说 -->
                                <Option text="EventText.touhou_akyuu_ufo_mission03.o3">
                                    <ConversationAction text="EventText.touhou_akyuu_ufo_mission03.c3" dialogtype="Small" targettag="triggerer_player" eventsprite="touhou_akyuu_mission"/>
                                    <ClearTagAction tag="triggerer_player"/>
                                    <GoTo name="waitformission"/>
                                </Option>
                            </ConversationAction>
                        </Failure>
                    </CheckDataAction>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="false"/>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--已击败封兽鵺-->
        <ScriptedEvent identifier="touhou_akyuu_ufo_mission04" commonness="0">
            <CheckDataAction identifier="touhou_find_nue_mission_end" condition="eq true">
                <Success>

                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hieda_no_Akyuu" targettag="Mission_Hieda_no_Akyuu" spawnlocation="MainSub" targetmoduletags="airlock"/>
                    <Label name="waitformission"/>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="true"/>
                    <TriggerAction target1tag="Mission_Hieda_no_Akyuu" target2tag="player" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c1" eventsprite="touhou_akyuu_mission">
                        <!-- 选项1：说明封兽鵺身份 -->
                        <Option text="EventText.touhou_akyuu_ufo_mission04.o1">
                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission04.c2" eventsprite="touhou_akyuu_mission">
                                <Option text="EventText.touhou_akyuu_ufo_mission04.o2">
                                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c3" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_ufo_mission04.o3">
                                            <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c4" eventsprite="touhou_akyuu_mission">
                                                <Option text="EventText.touhou_akyuu_ufo_mission04.o4">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c5" eventsprite="touhou_akyuu_mission"/>
                                                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c6" eventsprite="touhou_akyuu_mission"/>
                                                    <SpawnAction itemidentifier="Touhou_Missions_Collection_Nue" targetinventory="triggerer_player"/>
                                                    <MissionAction missiontag="Salvage_Mysterious_Pearl"/>
                                                    <SetDataAction identifier="touhou_find_nue_mission_end" value="true"/>
                                                    <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                                    <ClearTagAction tag="triggerer_player"/>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Option>
                        <!-- 选项2：感叹战斗压力 -->
                        <Option text="EventText.touhou_akyuu_ufo_mission04.o5">
                            <ConversationAction targettag="triggerer_player" dialogtype="Small" text="EventText.touhou_akyuu_ufo_mission04.c7" eventsprite="touhou_akyuu_mission">
                                <Option text="EventText.touhou_akyuu_ufo_mission04.o2">
                                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c3" eventsprite="touhou_akyuu_mission">
                                        <Option text="EventText.touhou_akyuu_ufo_mission04.o3">
                                            <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c4" eventsprite="touhou_akyuu_mission">
                                                <Option text="EventText.touhou_akyuu_ufo_mission04.o4">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c5" eventsprite="touhou_akyuu_mission"/>
                                                    <ConversationAction targettag="triggerer_player" text="EventText.touhou_akyuu_ufo_mission04.c6" eventsprite="touhou_akyuu_mission"/>
                                                    <SpawnAction itemidentifier="Touhou_Missions_Collection_Nue" targetinventory="triggerer_player"/>
                                                    <MissionAction missiontag="Salvage_Mysterious_Pearl"/>
                                                    <SetDataAction identifier="touhou_find_nue_mission_end" value="true"/>
                                                    <SetDataAction identifier="touhou_ufo_mission_ing" value="false"/>
                                                    <ClearTagAction tag="triggerer_player"/>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Option>
                    </ConversationAction>
                    <NPCWaitAction npctag="Mission_Hieda_no_Akyuu" wait="false"/>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--下一个任务线留给皮丝-->
        <!--琪露诺入组-->
        <ScriptedEvent identifier="Cirno_Join" commonness="200">
            <CheckDataAction identifier="cirno_join_complete" condition="eq true">
                <Success>
                    <!--Don't repeat event-->
                </Success>
                <Failure>
                    <TagAction criteria="player" tag="player"/>
                    <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Yousei_Cirno" targettag="Cirno" spawnlocation="Outpost" targetmoduletags="airlock"/>
                    <Label name="waitfortalk"/>
                    <TriggerAction target1tag="Cirno" target2tag="player" applytotarget1="targetCirno" applytotarget2="triggerer_player" radius="200" waitforinteraction="true"/>
                    <ConversationAction targettag="triggerer_player" speakertag="Cirno" text="EventText.cirno_join.c1" eventsprite="Cirno_Join">
                        <!-- 继续 -->
                        <Option text="EventText.cirno_join.o1">
                            <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c2" eventsprite="Cirno_Join">
                                <!-- 蓝色的头发，还有一对水晶般的翅膀，光是看过去就让你身体感到一阵寒意 -->
                                <Option text="EventText.cirno_join.o2">
                                    <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c3" eventsprite="Cirno_Join">
                                        <!-- 主动询问是否需要帮助 -->
                                        <Option text="EventText.cirno_join.o3">
                                            <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c4" eventsprite="Cirno_Join">
                                                <!-- 检视纸张 -->
                                                <Option text="EventText.cirno_join.o4">
                                                    <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c5" eventsprite="Cirno_Join">
                                                        <!-- 帮他算出结果 -->
                                                        <Option text="EventText.cirno_join.o5">
                                                            <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c6" eventsprite="Cirno_Join">
                                                                <!-- 选中我？ -->
                                                                <Option text="EventText.cirno_join.o6">
                                                                    <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c7" eventsprite="Cirno_Join"/>
                                                                    <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c8" eventsprite="Cirno_Join">
                                                                        <!-- 带她上潜艇 -->
                                                                        <Option text="EventText.cirno_join.o7">
                                                                            <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c9" eventsprite="Cirno_Join"/>
                                                                            <ConversationAction targettag="triggerer_player" text="EventText.cirno_join.c10" eventsprite="Cirno_Join"/>
                                                                            <NPCChangeTeamAction npctag="Yousei_Cirno" teamid="Team1" addtocrew="true"/>
                                                                            <SetDataAction identifier="cirno_join_complete" value="true"/>
                                                                            <ClearTagAction tag="triggerer_player"/>
                                                                        </Option>
                                                                    </ConversationAction>
                                                                </Option>
                                                            </ConversationAction>
                                                        </Option>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                            </ConversationAction>
                        </Option>
                    </ConversationAction>
                </Failure>
            </CheckDataAction>
        </ScriptedEvent>

        <!--站点简单任务-->
        <ScriptedEvent identifier="Touhou_Easy_Mission01" commonness="100">
            <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hakurei_Reimu" targettag="missionnpc" spawnlocation="Outpost"
                         spawnpointtype="Human"/>
            <ConversationAction text="EventText.Touhou_Easy_Mission01.c1" speakertag="missionnpc" endeventifinterrupted="false" dialogtype="Small"
                                eventsprite="Reimu_Mission"/>
            <MissionAction missiontag="Touhou_Mission_Easy"/>
            <MissionAction missiontag="Touhou_Mission_Easy"/>
            <MissionAction missiontag="killmonster_set2"/>
        </ScriptedEvent>

        <!--站点一般任务-->
        <ScriptedEvent identifier="Touhou_Normal_Mission01" commonness="100">
            <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hakurei_Reimu" targettag="missionnpc" spawnlocation="Outpost"
                         spawnpointtype="Human"/>
            <ConversationAction text="EventText.Touhou_Normal_Mission01.c1" speakertag="missionnpc" endeventifinterrupted="false" dialogtype="Small"
                                eventsprite="Reimu_Mission"/>
            <MissionAction missiontag="Touhou_Mission_Normal"/>
            <MissionAction missiontag="Touhou_Mission_Normal"/>
            <MissionAction missiontag="killmonster_set3"/>
            <!--      <CheckDataAction identifier="Touhou_Monster_Spectral_Mission01_Completed" condition="eq true">
                    <Success>
                      <MissionAction MissionIdentifier="Touhou_Monster_Spectral_Mission03" />
                    </Success>
                    <Failure>
                    </Failure>
                  </CheckDataAction>-->
        </ScriptedEvent>

        <!--站点困难任务-->
        <ScriptedEvent identifier="Touhou_Hard_Mission01" commonness="100">
            <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Mission_Hakurei_Reimu" targettag="missionnpc" spawnlocation="Outpost"
                         spawnpointtype="Human"/>
            <ConversationAction text="EventText.Touhou_Hard_Mission01.c1" speakertag="missionnpc" endeventifinterrupted="false" dialogtype="Small"
                                eventsprite="Reimu_Mission"/>
            <MissionAction missiontag="Touhou_Mission_Hard"/>
            <MissionAction missiontag="Touhou_Mission_Hard"/>
            <MissionAction missiontag="Touhou_Mission_Hard"/>
            <MissionAction missiontag="killmonster_set4"/>
        </ScriptedEvent>

        <!--站点商人01-->
        <!--    <ScriptedEvent identifier="Touhou_Merchant_Event01" commonness="100">
              <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Costume_Merchant_Kawasiro_Nitori" spawnlocation="Outpost" spawnpointtype="Human" />
            </ScriptedEvent>-->


        <!--河童卫星事件-->
        <ScriptedEvent identifier="Touhou_Kappa_Satellite_Event" commonness="0">
            <TagAction criteria="player" tag="player"/>
            <SpawnAction npcsetidentifier="touhounpc" npcidentifier="Satellite_Event_Kawasiro_Nitori" targettag="Satellite_Event_Kawasiro_Nitori"
                         spawnlocation="Outpost" targetmoduletags="admin,adminmodule"/>
            <Label name="waitfortalk"/>
            <NPCWaitAction npctag="Satellite_Event_Kawasiro_Nitori" wait="true"/>
            <TriggerAction target1tag="Satellite_Event_Kawasiro_Nitori" target2tag="player" applytotarget2="triggerer_player" radius="200"
                           waitforinteraction="true"/>
            <ConversationAction targettag="triggerer_player" speakertag="Satellite_Event_Kawasiro_Nitori"
                                text="Eventtext.Touhou_Kappa_Satellite_Event.c1"/>
            <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2">
                <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1" endconversation="true">
                    <GoTo name="waitfortalk"/>
                </Option>
                <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1">
                    <CheckItemAction targettag="triggerer_player" itemidentifiers="Touhou_Magic_Crystal_Mission">
                        <Failure>
                            <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o2.c1">
                                <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c1.o1">
                                    <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c1.o1.c1"/>
                                    <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c1.o1.c2"/>
                                    <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c1.o1.c3">
                                        <SpawnAction itemidentifier="Touhou_Special_Material_Mission" targetinventory="triggerer_player"/>
                                    </ConversationAction>
                                </Option>
                                <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1" endconversation="true">
                                    <GoTo name="waitfortalk"/>
                                </Option>
                            </ConversationAction>
                        </Failure>
                        <Success>
                            <Label name="Check_Touhou_Magic_Crystal_Mission"/>
                            <RemoveItemAction targettag="triggerer_player" itemidentifier="Touhou_Magic_Crystal_Mission"/>
                            <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c2"/>
                            <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3">
                                <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o1">
                                    <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o1.c1"/>
                                    <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o1.c2">
                                        <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o1.c2.o1">
                                            <ConversationAction targettag="triggerer_player"
                                                                text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o1.c2.o1.c1">
                                                <Label name="Another_Option_Callback"/>
                                                <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o1.c2.o1.c1.o1">
                                                    <ConversationAction targettag="triggerer_player"
                                                                        text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o1.c2.o1.c1.o1.c1">
                                                        <MissionAction missionidentifier="Touhou_Rocket_Event_Mission01" locationtype="Abandoned"
                                                                       CreateLocationIfNotFound="true"/>
                                                    </ConversationAction>
                                                </Option>
                                            </ConversationAction>
                                        </Option>
                                    </ConversationAction>
                                </Option>
                                <Option text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o2">
                                    <ConversationAction targettag="triggerer_player" text="Eventtext.Touhou_Kappa_Satellite_Event.c2.o1.c3.o2.c1"/>
                                    <GoTo name="Another_Option_Callback"/>
                                </Option>
                            </ConversationAction>
                        </Success>
                    </CheckItemAction>
                </Option>
            </ConversationAction>
        </ScriptedEvent>


    </EventPrefabs>

    <EventSet identifier="Touhou_Join" leveltype="outpost" allowatstart="true" minleveldifficulty="0" maxleveldifficulty="100" chooserandom="true"
              campaign="true" additive="true" selectalways="true" ignorecooldown="true" commonness="100" eventcount="2"
              locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine">
        <EventSet identifier="Touhou_All_Join_Events" minleveldifficulty="0" maxleveldifficulty="100" allowatstart="true" chooserandom="true"
                  onceperoutpost="true" eventcount="3">
            <EventSet identifier="Touhou_Join_Events" minleveldifficulty="0" maxleveldifficulty="100" allowatstart="true" chooserandom="true"
                      onceperoutpost="true" eventcount="1">
                <ScriptedEvent identifier="aya_join" commonness="200" triggercooldown="false"/>
                <ScriptedEvent identifier="Aya_Gift_List_Event" commonness="0" triggercooldown="false"/>
                <ScriptedEvent identifier="mokou_join" commonness="200" triggercooldown="false"/>
                <ScriptedEvent identifier="Momizi_Join" commonness="200" triggercooldown="false"/>
                <ScriptedEvent identifier="Momizi_Find_IDcard_Event" commonness="0" triggercooldown="false"/>
            </EventSet>
            <EventSet identifier="Touhou_Join_Events" minleveldifficulty="15" maxleveldifficulty="100" allowatstart="true" chooserandom="true"
                      onceperoutpost="true" eventcount="1" ignorecooldown="true" additive="true" selectalways="true" campaign="true">
                <ScriptedEvent identifier="patchouli_join" commonness="200" triggercooldown="false"/>
                <ScriptedEvent identifier="Tenshi_Join" commonness="200" triggercooldown="false"/>
                <ScriptedEvent identifier="youmujoin" commonness="200" triggercooldown="false"/>
            </EventSet>
            <EventSet identifier="Touhou_Join_Events" minleveldifficulty="36" maxleveldifficulty="100" allowatstart="true" chooserandom="true"
                      onceperoutpost="true" eventcount="1" ignorecooldown="true" additive="true" selectalways="true" campaign="true">
                <ScriptedEvent identifier="Cirno_Join" commonness="200" triggercooldown="false"/>
                <ScriptedEvent identifier="Tenshi_Join" commonness="200" triggercooldown="false"/>
                <ScriptedEvent identifier="youmujoin" commonness="200" triggercooldown="false"/>
            </EventSet>
        </EventSet>
    </EventSet>
<!--    <EventSet identifier="Touhou_Mission_Events_Akyuu" leveltype="outpost" minleveldifficulty="0" maxleveldifficulty="100" allowatstart="true"
              chooserandom="false" ignorecooldown="true" onceperoutpost="true" selectalways="true" campaign="true" additive="true"
              locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine,Touhou_Temporary_Shelter_LocationType">
        <ScriptedEvent identifier="Touhou_Akyuu_Mission" commonness="100" triggercooldown="false"/>
    </EventSet>-->
    <EventSet identifier="Touhou_Join_Events_Akyuu" leveltype="outpost" minleveldifficulty="0" maxleveldifficulty="100" allowatstart="true"
              chooserandom="true" onceperoutpost="true" campaign="true" additive="true" selectalways="true"
              locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine,Touhou_Temporary_Shelter_LocationType">
        <ScriptedEvent identifier="Akyuu_Join" commonness="70" triggercooldown="false"/>
    </EventSet>
    <EventSet identifier="Touhou_Mission_Events01" leveltype="outpost" allowatstart="true" minleveldifficulty="0" maxleveldifficulty="100"
              chooserandom="false" ignorecooldown="true" additive="true" selectalways="true" campaign="true">
        <EventSet identifier="Touhou_Mission_Events01_0_15" minleveldifficulty="0" maxleveldifficulty="15" allowatstart="true" chooserandom="true"
                  onceperoutpost="true" eventcount="1" additive="true" selectalways="true"
                  locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine,Touhou_Temporary_Shelter_LocationType">
            <ScriptedEvent identifier="Touhou_Easy_Mission01" commonness="100"/>
        </EventSet>
        <EventSet identifier="Touhou_Mission_Events01_15_36" minleveldifficulty="15" maxleveldifficulty="36" allowatstart="true" chooserandom="true"
                  onceperoutpost="true" eventcount="1" additive="true" selectalways="true"
                  locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine,Touhou_Temporary_Shelter_LocationType">
            <ScriptedEvent identifier="Touhou_Easy_Mission01" commonness="20"/>
            <ScriptedEvent identifier="Touhou_Normal_Mission01" commonness="100"/>
            <ScriptedEvent identifier="Touhou_Hard_Mission01" commonness="30"/>
            <!--      <ScriptedEvent identifier="Touhou_Lunatic_Mission01" commonness="10" />-->
        </EventSet>
        <EventSet identifier="Touhou_Mission_Events01_36_100" minleveldifficulty="36" maxleveldifficulty="100" allowatstart="true" chooserandom="true"
                  onceperoutpost="true" eventcount="1" additive="true" selectalways="true"
                  locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine,Touhou_Temporary_Shelter_LocationType">
            <ScriptedEvent identifier="Touhou_Normal_Mission01" commonness="30"/>
            <ScriptedEvent identifier="Touhou_Hard_Mission01" commonness="80"/>
            <!--      <ScriptedEvent identifier="Touhou_Lunatic_Mission01" commonness="100" />-->
        </EventSet>
    </EventSet>
    <EventSet identifier="Touhou_Mission_Events02" leveltype="outpost" allowatstart="true" minleveldifficulty="0" maxleveldifficulty="100"
              chooserandom="false" ignorecooldown="true" additive="true" selectalways="true" campaign="true">
        <EventSet identifier="Touhou_Mission_Events02_Akyuu" minleveldifficulty="0" maxleveldifficulty="100" allowatstart="true" chooserandom="true"
                  onceperoutpost="true" eventcount="1" additive="true" selectalways="true"
                  locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine,Touhou_Temporary_Shelter_LocationType">
            <ScriptedEvent identifier="Touhou_Akyuu_Mission" commonness="50"/>
        </EventSet>
    </EventSet>
    <!--  <EventSet identifier="Touhou_Merchant_Events01" leveltype="outpost" allowatstart="true" minleveldifficulty="0" maxleveldifficulty="100" chooserandom="false" ignorecooldown="true" additive="true" selectalways="true" campaign="true">
        <EventSet identifier="Touhou_Merchant_Events01_Nitori" minleveldifficulty="0" maxleveldifficulty="40" allowatstart="true" chooserandom="true" onceperoutpost="true" eventcount="1" additive="true" selectalways="true"
                  locationtype="outpost,city,research,military,mine,colony,settlement,construction,camp,base,blockade,survey,excavation,study,lab,clinic,hospital,surgery,hydroponics,biosphere,nourishment,factory,shipyard,fusion,tsm_city,tsm_military,tsm_mine">
          <ScriptedEvent identifier="Touhou_Merchant_Event01" commonness="100" />
        </EventSet>
      </EventSet>-->
    <!--  <EventSet identifier="Touhou_Mission_Events02" leveltype="outpost" allowatstart="true" minleveldifficulty="0" maxleveldifficulty="100" chooserandom="true" ignorecooldown="true" additive="true" selectalways="true" commonness="100" campaign="true">

      </EventSet>
      <EventSet identifier="Touhou_Mission_Events03" leveltype="outpost" allowatstart="true" minleveldifficulty="0" maxleveldifficulty="100" chooserandom="true" ignorecooldown="true" additive="true" selectalways="true" commonness="100" campaign="true">

      </EventSet>-->
</Randomevents>